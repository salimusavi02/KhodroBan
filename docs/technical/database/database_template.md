# مستندات ساختار دیتابیس

**نام دیتابیس:**
**نسخه:**
**تاریخ آخرین به‌روزرسانی:**
**توضیح کلی دیتابیس:**

## جداول

### [نام جدول به انگلیسی]

**توضیح مختصر جدول:**

#### فیلدها

| نام انگلیسی فیلد | نام فارسی فیلد | اجباری/اختیاری | نوع داده | اندازه | کلید اصلی (PK) | کلید خارجی (FK) | پیش‌فرض | توضیحات |
| ------------------------------ | -------------------------- | --------------------------- | --------------- | ------------ | ---------------------- | ------------------------ | -------------- | -------------- |
|                                |                            |                             |                 |              |                        |                          |                |                |

#### روابط جدول

- **یک به چند (One-to-Many):**
- **چند به چند (Many-to-Many):**
- **چند به یک (Many-to-One):**

#### ایندکس‌ها

## دیکشنری داده‌ها (Data Dictionary)

| نام جدول | ستون | نوع داده | طول | کلید اصلی/خارجی | مقادیر مجاز | توضیحات |
| --------------- | -------- | --------------- | ------ | ---------------------------- | --------------------- | -------------- |
|                 |          |                 |        |                              |                       |                |

## روابط کلی دیتابیس

## محدودیت‌ها (Constraints)

## رویه‌ها و توابع ذخیره‌شده (Stored Procedures & Functions)

| نام | نوع | پارامترها | خروجی | توضیحات |
| ------ | ------ | ------------------ | ---------- | -------------- |
|        |        |                    |            |                |

## نمایه‌ها (Views)

| نام ویو | جداول مرجع | هدف |
| ------------- | ------------------- | ------ |
|               |                     |        |

## امنیت و دسترسی‌ها (Security & Access)

| نقش کاربری | دسترسی به جداول | سطح دسترسی | توضیحات |
| ------------------- | ---------------------------- | ------------------- | -------------- |
|                     |                              |                     |                |

## نکات اضافی

- **تریگرها:**
- **گسترش‌پذیری:**
- **پشتیبان‌گیری:**

---

# نمونه پر شده مستندات ساختار دیتابیس (برای سیستم وبلاگ ساده)

**نام دیتابیس:** BlogDB
**نسخه:** 1.0
**تاریخ آخرین به‌روزرسانی:** ۲۳ آذر ۱۴۰۴
**توضیح کلی دیتابیس:** دیتابیس ساده یک سیستم وبلاگ که شامل کاربران، پست‌ها و امکان گسترش به کامنت‌ها، دسته‌بندی‌ها و ... است.

## جداول

### Users

**توضیح مختصر جدول:** ذخیره اطلاعات کاربران سیستم

#### فیلدها

| نام انگلیسی فیلد | نام فارسی فیلد | اجباری/اختیاری | نوع داده | اندازه | کلید اصلی (PK) | کلید خارجی (FK) | پیش‌فرض    | توضیحات                               |
| ------------------------------ | -------------------------- | --------------------------- | --------------- | ------------ | ---------------------- | ------------------------ | ----------------- | -------------------------------------------- |
| user_id                        | شناسه کاربر      | اجباری                | INT             | 11           | بله                 | -                        | AUTO_INCREMENT    | شناسه یکتای کاربر             |
| username                       | نام کاربری        | اجباری                | VARCHAR         | 50           | خیر                 | -                        | -                 | نام کاربری برای ورود        |
| email                          | ایمیل                 | اجباری                | VARCHAR         | 100          | خیر                 | -                        | -                 | ایمیل کاربر                        |
| created_at                     | تاریخ ایجاد      | اجباری                | TIMESTAMP       | -            | خیر                 | -                        | CURRENT_TIMESTAMP | تاریخ و زمان ایجاد رکورد |

#### روابط جدول

- **یک به چند (One-to-Many):** این جدول با جدول `Posts` رابطه یک به چند دارد (یک کاربر می‌تواند چندین پست داشته باشد) – از طریق فیلد `user_id` در جدول Posts.

#### ایندکس‌ها

- PRIMARY KEY روی `user_id`
- UNIQUE INDEX روی `username`
- UNIQUE INDEX روی `email`

### Posts

**توضیح مختصر جدول:** ذخیره پست‌های نوشته‌شده توسط کاربران

#### فیلدها

| نام انگلیسی فیلد | نام فارسی فیلد | اجباری/اختیاری | نوع داده | اندازه | کلید اصلی (PK) | کلید خارجی (FK)          | پیش‌فرض    | توضیحات                           |
| ------------------------------ | -------------------------- | --------------------------- | --------------- | ------------ | ---------------------- | --------------------------------- | ----------------- | ---------------------------------------- |
| post_id                        | شناسه پست          | اجباری                | INT             | 11           | بله                 | -                                 | AUTO_INCREMENT    | شناسه یکتای پست             |
| user_id                        | شناسه کاربر      | اجباری                | INT             | 11           | خیر                 | Users.user_id (ON DELETE CASCADE) | -                 | شناسه کاربر نویسنده     |
| title                          | عنوان                 | اجباری                | VARCHAR         | 200          | خیر                 | -                                 | -                 | عنوان پست                        |
| content                        | محتوا                 | اجباری                | TEXT            | -            | خیر                 | -                                 | -                 | محتوای اصلی پست             |
| created_at                     | تاریخ ایجاد      | اجباری                | TIMESTAMP       | -            | خیر                 | -                                 | CURRENT_TIMESTAMP | تاریخ و زمان ایجاد پست |

#### روابط جدول

- **چند به یک (Many-to-One):** این جدول به جدول `Users` از طریق `user_id` متصل است.

#### ایندکس‌ها

- PRIMARY KEY روی `post_id`
- INDEX معمولی روی `user_id` (برای جستجوی سریع پست‌های یک کاربر)
- INDEX روی `created_at` (برای مرتب‌سازی بر اساس تاریخ)

## دیکشنری داده‌ها (Data Dictionary)

| نام جدول | ستون   | نوع داده | طول | کلید اصلی/خارجی            | مقادیر مجاز     | توضیحات                               |
| --------------- | ---------- | --------------- | ------ | --------------------------------------- | ------------------------- | -------------------------------------------- |
| **Users** | user_id    | INT             | 11     | PK (Auto Increment)                     | -                         | شناسه یکتای کاربر             |
|                 | username   | VARCHAR         | 50     | UNIQUE                                  | [a-zA-Z0-9_]              | نام کاربری برای ورود        |
|                 | email      | VARCHAR         | 100    | UNIQUE                                  | ایمیل معتبر     | ایمیل کاربر                        |
|                 | created_at | TIMESTAMP       | -      | -                                       | DEFAULT CURRENT_TIMESTAMP | تاریخ و زمان ایجاد رکورد |
| **Posts** | post_id    | INT             | 11     | PK (Auto Increment)                     | -                         | شناسه یکتای پست                 |
|                 | user_id    | INT             | 11     | FK → Users.user_id (ON DELETE CASCADE) | -                         | شناسه کاربر نویسنده         |
|                 | title      | VARCHAR         | 200    | NOT NULL                                | -                         | عنوان پست                            |
|                 | content    | TEXT            | -      | NOT NULL                                | -                         | محتوای اصلی پست                 |
|                 | created_at | TIMESTAMP       | -      | -                                       | DEFAULT CURRENT_TIMESTAMP | تاریخ و زمان ایجاد پست     |

## روابط کلی دیتابیس

- **Users** → **Posts**: یک به چند (One-to-Many)
  یک کاربر می‌تواند چندین پست داشته باشد. کلید خارجی: `Posts.user_id` → `Users.user_id`

## محدودیت‌ها (Constraints)

- NOT NULL روی فیلدهای اجباری (`username`, `email`, `title`, `content`)
- UNIQUE روی `username` و `email` در جدول Users
- FOREIGN KEY با رفتار ON DELETE CASCADE برای پست‌ها هنگام حذف کاربر

## رویه‌ها و توابع ذخیره‌شده (Stored Procedures & Functions)

| نام               | نوع    | پارامترها | خروجی                    | توضیحات                                                             |
| -------------------- | --------- | ------------------ | ----------------------------- | -------------------------------------------------------------------------- |
| `sp_GetUserPosts`  | Procedure | @userId INT        | TABLE (لیست پست‌ها) | دریافت تمام پست‌های یک کاربر مشخص              |
| `fn_CountComments` | Function  | @postId INT        | INT                           | شمارش تعداد کامنت‌های یک پست (قابل گسترش) |

## نمایه‌ها (Views)

| نام ویو          | جداول مرجع | هدف                                                                                                       |
| ---------------------- | ------------------- | ------------------------------------------------------------------------------------------------------------ |
| `vw_UserPostSummary` | Users, Posts        | نمایش خلاصه کاربران همراه با تعداد پست‌های هر کدام (با GROUP BY) |

## امنیت و دسترسی‌ها (Security & Access)

| نقش کاربری | دسترسی به جداول        | سطح دسترسی                       | توضیحات                             |
| ------------------- | ----------------------------------- | ----------------------------------------- | ------------------------------------------ |
| `admin`           | تمام جداول                 | CRUD کامل + مدیریت نقش‌ها | دسترسی کامل به سیستم      |
| `editor`          | Posts (و در آینده Comments) | CRUD                                      | ایجاد، ویرایش و حذف پست |
| `viewer`          | Posts (و در آینده Comments) | Read-only                                 | فقط مشاهده محتوا             |

## نکات اضافی

- **تریگرها:** در حال حاضر تعریف نشده (قابلیت اضافه کردن برای به‌روزرسانی فیلد updated_at)
- **گسترش‌پذیری:** طراحی به گونه‌ای است که به راحتی بتوان جداول Comments، Categories و Tags را اضافه کرد.
- **پشتیبان‌گیری:** توصیه به بک‌آپ روزانه از جداول اصلی.
